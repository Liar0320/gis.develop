!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=23)}([function(t,e,n){"use strict";function r(){return function(){throw new Error("Unimplemented abstract method.")}()}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return s}));var o=0;function i(t){return t.ol_uid||(t.ol_uid=String(++o))}var s="6.2.1"},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,o=n(0),i=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){var n=this,r="Assertion failed. See https://openlayers.org/en/"+("latest"===o.a?o.a:"v"+o.a.split("-")[0])+"/doc/errors/#"+e+" for details.";return(n=t.call(this,r)||this).code=e,n.name="AssertionError",n.message=r,n}return i(e,t),e}(Error);function a(t,e){if(!t)throw new s(e)}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=n(13),s=function(){function t(t){this.componentType="map",this.onDblClick=o.noop,this.onPointerDrag=o.noop,this.onPointerMove=o.noop,this.onPostCompose=o.noop,this.onPostRender=o.noop,this.onPreCompose=o.noop,this.onPropertyChange=o.noop,this.onSingleClick=o.noop,this.onClick=o.noop,this.onMoveEnd=o.noop,this.controls=[],this.interactions=[],this.host=t}return t.prototype.$onInit=function(){var t=this;this.instance=new i.Map(this),this.instance.setTarget(this.host[0]),this.instance.on("click",(function(e){return t.onClick({event:e})})),this.instance.on("dblclick",(function(e){return t.onDblClick({event:e})})),this.instance.on("moveend",(function(e){return t.onMoveEnd({event:e})})),this.instance.on("pointerdrag",(function(e){return t.onPointerDrag({event:e})})),this.instance.on("pointermove",(function(e){return t.onPointerMove({event:e})})),this.instance.on("postcompose",(function(e){return t.onPostCompose({event:e})})),this.instance.on("postrender",(function(e){return t.onPostRender({event:e})})),this.instance.on("precompose",(function(e){return t.onPreCompose({event:e})})),this.instance.on("propertychange",(function(e){return t.onPropertyChange({event:e})})),this.instance.on("singleclick",(function(e){return t.onSingleClick({event:e})}))},t}();e.MapComponent=s;var a={bindings:{pixelRatio:"<?",keyboardEventTarget:"<?",onClick:"&?",onDblClick:"&?",onMoveEnd:"&?",onPointerDrag:"&?",onPointerMove:"&?",onPostcompose:"&?",onPostrender:"&?",onPreCompose:"&?",onPropertyChange:"&?",onRenderComplete:"&?",onSingleClick:"&?"},controller:["$element",s]};e.default=r({name:"aolMap"},a)},function(t,e,n){"use strict";function r(t,e){return t>e?1:t<e?-1:0}function o(t,e){return t.indexOf(e)>=0}function i(t,e,n){var r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;var o=void 0;if(n>0){for(o=1;o<r;++o)if(t[o]<e)return o-1}else if(n<0){for(o=1;o<r;++o)if(t[o]<=e)return o}else for(o=1;o<r;++o){if(t[o]==e)return o;if(t[o]<e)return t[o-1]-e<e-t[o]?o-1:o}return r-1}function s(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function a(t,e,n){var o=e||r;return t.every((function(e,r){if(0===r)return!0;var i=o(t[r-1],e);return!(i>0||n&&0===i)}))}n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return a}))},function(t,e,n){"use strict";function r(t,e,n){return Math.min(Math.max(t,e),n)}n.d(e,"a",(function(){return r}));"cosh"in Math&&Math.cosh},function(t,e){t.exports=angular},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return a}));n(1);function r(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function o(){return[1/0,1/0,-1/0,-1/0]}function i(t,e,n,r,o){return o?(o[0]=t,o[1]=e,o[2]=n,o[3]=r,o):[t,e,n,r]}function s(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function a(t){return[t[0],t[3]]}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(25)),r(n(26)),r(n(27)),r(n(28))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.componentType="source"}return t.prototype.$onDestroy=function(){this.host&&this.host.instance.setSource(null)},t.prototype._register=function(t){this.host&&this.host.instance.setSource(t)},t}();e.SourceComponent=r,e.sourceComponentConfig={bindings:{instance:"=?",attributions:"<?",attributionsCollapsible:"<?"}}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),i=n(7),s=n(10),a=function(){function t(){this.componentType="style"}return t.prototype.$onInit=function(){if(this.featureHost)this.host=this.featureHost;else{if(!this.layerVectorHost)throw new Error("aol-style must be applied to a feature or a layer");this.host=this.layerVectorHost}this.instance=new s.Style(this),this.host.instance.setStyle(this.instance)},t.prototype.update=function(){this.host.instance.changed()},t.prototype.$onDestroy=function(){var t=this.host.instance.getStyle();t instanceof Array?t.splice(t.indexOf(this.instance),1):t=null,this.host.instance.setStyle(t)},t}();e.StyleComponent=a;var u={bindings:{geometry:"<?",fill:"<?",image:"<?",stroke:"<?",text:"<?",zIndex:"<?"},require:{layerVectorHost:"?^"+i.aolLayerVector.name,featureHost:"?^"+o.default.name},controller:[a]};e.aolStyle=r({name:"aolStyle"},u)},function(t,e){t.exports=ol.style},function(t,e){t.exports=ol.source},function(t,e){t.exports=ol.interaction},function(t,e){t.exports=ol},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=function(){function t(){this.componentType="layer"}return t.prototype.$onInit=function(){this.host=this.layerGroupComponent||this.mapComponent,null!==this.prerender&&void 0!==this.prerender&&this.instance.on("prerender",this.prerender),null!==this.postrender&&void 0!==this.postrender&&this.instance.on("postrender",this.postrender),this.host.instance.getLayers().push(this.instance)},t.prototype.$onDestroy=function(){this.host.instance.getLayers().remove(this.instance)},t.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)if(t.hasOwnProperty(n))switch(n){case"prerender":this.instance.un("prerender",t[n].previousValue),this.instance.on("prerender",t[n].currentValue);break;case"postrender":this.instance.un("postrender",t[n].previousValue),this.instance.on("postrender",t[n].currentValue);break;case"source":this.instance.setSource(t[n].currentValue);break;default:e[n]=t[n].currentValue}this.instance.setProperties(e,!1)}},t}();e.LayerComponent=o,e.layerComponentConfig={bindings:{opacity:"<?",visible:"<?",extent:"<?",zIndex:"<?",minResolution:"<?",maxResolution:"<?",className:"<?",prerender:"&?",postrender:"&?"},require:{mapComponent:"?^"+r.default.name,layerGroupComponent:"?^^aolLayerGroup"}}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),i=n(19),s=function(){function t(){this.componentType="feature"}return t.prototype.$onInit=function(){this.instance=new o.Feature,void 0!==this.id&&this.instance.setId(this.id),void 0!==this.properties&&this.instance.setProperties(this.properties),this.host.instance.addFeature(this.instance)},t.prototype.$onDestroy=function(){this.host.instance.removeFeature(this.instance)},t.prototype.$onChanges=function(t){this.instance&&(t.properties?this.instance.setProperties(t.properties,!0):this.instance.setId(this.id))},t}();e.FeatureComponent=s;var a={bindings:{id:"<?",properties:"<?"},require:{host:"^"+i.aolSourceVector.name},controller:["$element",s]};e.default=r({name:"aolFeature"},a)},function(t,e){t.exports=ol.layer},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=n(10),s=function(){function t(){this.componentType="style-circle",this.radius=5}return t.prototype.$onInit=function(){if(!this.styleHost)throw new Error("aol-circle must be applied to a feature or a layer");this.host=this.styleHost},t.prototype.$postLink=function(){this.instance=new i.Circle(this),this.host.instance.setImage(this.instance)},t.prototype.update=function(){this.instance&&(this.instance=new i.Circle(this),this.host.instance.setImage(this.instance)),this.host.update()},t.prototype.$onDestroy=function(){this.host.instance.setImage(null)},t.prototype.$onChanges=function(t){this.instance&&t.radius&&this.instance.setRadius(t.radius.currentValue)},t}();e.styleCircleComponent=s;var a={bindings:{fill:"<?",radius:"<?",snapToPixel:"<?",stroke:"<?"},require:{styleHost:"?^"+o.aolStyle.name},controller:[s]};e.aolStyleCircle=r({name:"aolStyleCircle"},a)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),i=n(2),s=function(){function t(){this.componentType="view",this.zoom=11,this.center=[104.06,30.67],this.zoomAnimation=!1}return t.prototype.$onInit=function(){this.instance=new o.View(this),this.host.instance.setView(this.instance)},t.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)if(t.hasOwnProperty(n)){switch(n){case"zoom":this.zoomAnimation?this.instance.animate({zoom:t[n].currentValue}):this.instance.setZoom(t[n].currentValue)}e[n]=t[n].currentValue}this.instance.setProperties(e,!1)}},t}();e.ViewComponent=s;var a={bindings:{constrainRotation:"<?",enableRotation:"<?",extent:"<?",maxResolution:"<?",minResolution:"<?",maxZoom:"<?",minZoom:"<?",resolution:"<?",resolutions:"<?",rotation:"<?",zoom:"<",zoomFactor:"<?",center:"<?",projection:"<?",zoomAnimation:"<?"},require:{host:"^"+i.default.name},controller:["$element",s]};e.default=r({name:"aolView"},a)},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(24)),r(n(30)),r(n(31)),r(n(32)),r(n(33))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=n(15),s=n(21),a=function(){function t(){this.componentType="geometry-linestring",this.change=o.noop}return t.prototype.$onInit=function(){var t=this;this.instance=new s.LineString([]),this.instance.on("change",(function(e){return t.change({event:e})})),this.host.instance.setGeometry(this.instance)},t.prototype.$onDestroy=function(){},t}();e.GeometryLinestringComponent=a;var u={bindings:{change:"&?"},require:{host:"^"+i.default.name},controller:[a]};e.aolGeometryLinestring=r({name:"aolGeometryLinestring"},u);var c=function(){function t(){this.componentType="geometry-point"}return t.prototype.$onInit=function(){this.instance=new s.Point([0,0]),this.host.instance.setGeometry(this.instance)},t.prototype.$onDestroy=function(){},t}();e.GeometryPointComponent=c;var h={bindings:{},require:{host:"^"+i.default.name},controller:[c]};e.aolGeometryPoint=r({name:"aolGeometryPoint"},h);var l=function(){function t(){this.componentType="geometry-polygon"}return t.prototype.$onInit=function(){this.instance=new s.Polygon([[[0,0],[1,0],[1,1]]]),this.host.instance.setGeometry(this.instance)},t}();e.GeometryPolygonComponent=l;var f={bindings:{},require:{host:"^"+i.default.name},controller:[l]};e.aolGeometryPolygon=r({name:"aolGeometryPolygon"},f)},function(t,e){t.exports=ol.geom},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=n(10),s=function(){function t(){this.componentType="style-text"}return t.prototype.$onInit=function(){if(!this.host)throw new Error("aol-style-icon must be applied to a style component");this.instance=new i.Text(this),this.host.instance.setText(this.instance),this.host.update()},t.prototype.$onDestroy=function(){this.host.instance.setText(null),this.host.update()},t.prototype.$onChanges=function(t){this.instance&&(t.font&&this.instance.setFont(t.font.currentValue),t.offsetX&&this.instance.setOffsetX(t.offsetX.currentValue),t.offsetY&&this.instance.setOffsetY(t.offsetY.currentValue),t.scale&&this.instance.setScale(t.scale.currentValue),t.rotation&&this.instance.setRotation(t.rotation.currentValue),t.text&&this.instance.setText(t.text.currentValue),t.textAlign&&this.instance.setTextAlign(t.textAlign.currentValue),t.textBaseLine&&this.instance.setTextBaseline(t.textBaseLine.currentValue),this.host.update())},t}();e.styleTextComponent=s;var a={bindings:{font:"<?",maxAngle:"<?",offsetX:"<?",offsetY:"<?",overflow:"<?",placement:"<?",scale:"<?",rotateWithView:"<?",rotation:"<?",text:"<?",textAlign:"<?",textBaseline:"<?",fill:"<?",stroke:"<?",backgroundFill:"<?",backgroundStroke:"<?",padding:"<?"},require:{host:"?^"+o.aolStyle.name},controller:[s]};e.aolStyleText=r({name:"aolStyleText"},a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(2),i=n(18),s=n(15),a=n(7),u=n(19),c=n(20),h=n(34),l=n(36),f=n(40),p=n(41),y=n(50),d=r.module("aol",[]);[o.default,i.default,a.aolLayerTile,a.aolLayerVector,a.aolLayerWebgl,a.aolLayerGroup,u.aolSourceXyz,u.aolSourceOsm,u.aolSourceVector,u.aolSourceCluster,u.aolSourceTiledebug,s.default,c.aolGeometryLinestring,c.aolGeometryPoint,c.aolGeometryPolygon,h.aolCoordinate,h.aolCollectionCoordinates,l.aolStyle,l.aolStyleStroke,l.aolStyleCircle,l.aolStyleIcon,l.aolStyleText,l.aolStyleFill,f.aolOverlay,p.aolInteractionDefaults,y.aolInteractionDraw,p.aolInteractionModify,p.aolInteractionSelect,p.aolInteractionDraganddrop].forEach((function(t){!function(t){d.component(t.name,t)}(t)})),e.default=d},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),a=n(11),u=n(7),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="sourceXYZComponent",e}return o(e,t),e.prototype.$onInit=function(){t.prototype.decorate.call(this),this.instance=new a.XYZ(this),this._register(this.instance)},e.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n].currentValue);this.instance.setProperties(e,!1),(t.hasOwnProperty("url")||t.hasOwnProperty("tileGrid"))&&this.$onInit()}},e}(n(29).SourceXYZExtend);e.SourceXYZComponent=c;var h={bindings:i(i({},s.sourceComponentConfig.bindings),{cacheSize:"<?",crossOrigin:"<?",opaque:"<?",projection:"<?",reprojectionErrorThreshold:"<?",minZoom:"<?",maxZoom:"<?",tileGrid:"<?",tileLoadFunction:"<?",tilePixelRatio:"<?",tileSize:"<?",tileUrlFunction:"<?",url:"<?",urls:"<?",wrapX:"<?",transition:"<?",zDirection:"<?"}),require:{host:"^"+u.aolLayerTile.name},controller:["$element",c]};e.aolSourceXyz=i({name:"aolSourceXyz"},h)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(14),a=n(16),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.$onInit=function(){this.instance=new a.Tile(this),t.prototype.$onInit.call(this)},e.prototype.$onChanges=function(e){t.prototype.$onChanges.call(this,e)},e}(s.LayerComponent);e.LayerTileComponent=u;var c={bindings:i(i({},s.layerComponentConfig.bindings),{preload:"<?",useInterimTilesOnError:"<?"}),require:s.layerComponentConfig.require,controller:[u]};e.aolLayerTile=i({name:"aolLayerTile"},c)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(14),a=n(16),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="LayerVectorComponent",e}return o(e,t),e.prototype.$onInit=function(){this.instance=new a.Vector(this),t.prototype.$onInit.call(this)},e.prototype.$onChanges=function(e){t.prototype.$onChanges.call(this,e)},e}(s.LayerComponent);e.LayerVectorComponent=u;var c={bindings:i(i({},s.layerComponentConfig.bindings),{renderOrder:"<?",renderBuffer:"<?",source:"<?",declutter:"<?",style:"<?",updateWhileAnimating:"<?",updateWhileInteracting:"<?"}),require:s.layerComponentConfig.require,controller:[u]};e.aolLayerVector=i({name:"aolLayerVector"},c)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(14),a=n(16),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="LayerGroupComponent",e}return o(e,t),e.prototype.$onInit=function(){this.instance=new a.Group(this),t.prototype.$onInit.call(this)},e}(s.LayerComponent);e.LayerGroupComponent=u;var c={bindings:i({},s.layerComponentConfig.bindings),require:s.layerComponentConfig.require,controller:[u]};e.aolLayerGroup=i({name:"aolLayerGroup"},c)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(14),a=n(52),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="LayerVectorComponent",e.style={symbol:{symbolType:"circle",size:6,color:"#CD853F",offset:[0,0]}},e}return o(e,t),e.prototype.$onInit=function(){this.instance=new a.default(this),t.prototype.$onInit.call(this)},e.prototype.$onChanges=function(e){t.prototype.$onChanges.call(this,e)},e}(s.LayerComponent);e.LayerWebglComponent=u;var c={bindings:i(i({},s.layerComponentConfig.bindings),{style:"<?",className:"<?",opacity:"<?",visible:"<?",extent:"<?",zIndex:"<?",minResolution:"<?",maxResolution:"<?",source:"<?",disableHitDetection:"<?"}),require:s.layerComponentConfig.require,controller:[u]};e.aolLayerWebgl=i({name:"aolLayerWebgl"},c)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(53),s=n(8),a=[156543.03392804097,78271.51696402048,39135.75848201024,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.8740565703525,76.43702828517625,38.21851414258813,19.109257071294063,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,.5971642834779395,.29858214173896974,.14929107086948487,.07464553543474244,.03732276771737122,.01866138385868561,.009330691929342804,.004665345964671402,.002332672982335701,.0011663364911678506,.0005831682455839253,.00029158412279196264,.00014579206139598132,7289603069799066e-20,3644801534899533e-20,18224007674497665e-21,9112003837248832e-21,4556001918624416e-21,2278000959312208e-21,1139000479656104e-21,5.69500239828052e-7,2.84750119914026e-7,1.42375059957013e-7,7.11875299785065e-8,3.559376498925325e-8],u=[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,21457672119140625e-21,10728836059570312e-21,5364418029785156e-21,2682209014892578e-21,1341104507446289e-21,6.705522537231445e-7,3.3527612686157227e-7,1.6763806343078613e-7,8.381903171539307e-8,4.190951585769653e-8,2.0954757928848267e-8,1.0477378964424133e-8,5.238689482212067e-9,2.6193447411060333e-9,1.3096723705530167e-9,6.548361852765083e-10,3.2741809263825417e-10,1.6370904631912708e-10,8185452315956354e-26,4092726157978177e-26,20463630789890885e-27,10231815394945443e-27,5115907697472721e-27,25579538487363607e-28,12789769243681803e-28,6394884621840902e-28,3197442310920451e-28],c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.decorate=function(){this.tileGrid&&!this.tileGrid.forEachTileCoord&&(this.tileGrid.resolutions||(this.tileGrid.resolutions="EPSG:4326"===this.projection?u:a),this.tileGrid=new i.default(this.tileGrid))},e}(s.SourceComponent);e.SourceXYZExtend=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),a=n(11),u=n(7),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="SourceOSMComponent",e}return o(e,t),e.prototype.$onInit=function(){this.instance=new a.OSM(this),this._register(this.instance)},e.prototype.ngOnChanges=function(t){var e={};if(this.instance){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n].currentValue);this.instance.setProperties(e,!1),t.hasOwnProperty("url")&&(this.instance=new a.OSM(this),this._register(this.instance))}},e}(s.SourceComponent);e.SourceOSMComponent=c;var h={bindings:i(i({},s.sourceComponentConfig.bindings),{cacheSize:"<?",crossOrigin:"<?",opaque:"<?",reprojectionErrorThreshold:"<?",maxZoom:"<?",tileLoadFunction:"<?",url:"<?",wrapX:"<?"}),require:{host:"^"+u.aolLayerTile.name},controller:[c]};e.aolSourceOsm=i({name:"aolSourceOsm"},h)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),a=n(7),u=n(11),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="SourceVectorComponent",e}return o(e,t),e.prototype.$onInit=function(){if(this.layerVectorHost)this.host=this.layerVectorHost;else{if(!this.layerWebglHost)throw new Error("aol-source-vector must be applied to a Style or layerWebglHost or layerVectorHost component");this.host=this.layerWebglHost}this.instance=new u.Vector(this),this._register(this.instance)},e.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)if(t.hasOwnProperty(n))switch(n){case"features":this.instance.addFeatures(t[n].currentValue);break;default:e[n]=t[n].currentValue}this.instance.setProperties(e,!1)}},e}(s.SourceComponent);e.SourceVectorComponent=c;var h={bindings:i(i({},s.sourceComponentConfig.bindings),{features:"<?",format:"<?",loader:"<?",overlaps:"<?",strategy:"<?",url:"<?",useSpatialIndex:"<?",wrapX:"<?"}),require:{layerVectorHost:"^?"+a.aolLayerVector.name,layerWebglHost:"^?"+a.aolLayerWebgl.name},controller:[c]};e.aolSourceVector=i({name:"aolSourceVector"},h)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),a=n(11),u=n(7),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="SourceClusterComponent",e}return o(e,t),e.prototype.$onInit=function(){this.source&&(this.instance=new a.Cluster(this),this._register(this.instance))},e.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n].currentValue);this.instance.setProperties(e,!1),t.hasOwnProperty("source")&&(this.$onDestroy(),this.instance=new a.Cluster(this),this._register(this.instance))}else this.$onInit()},e}(s.SourceComponent);e.SourceClusterComponent=c;var h={bindings:i(i({},s.sourceComponentConfig.bindings),{distance:"<?",geometryFunction:"<?",source:"<",wrapX:"<?"}),require:{host:"^"+u.aolLayerVector.name},controller:["$element",c]};e.aolSourceCluster=i({name:"aolSourceCluster"},h)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),a=n(11),u=n(7),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentType="SourceTiledebugComponent",e}return o(e,t),e.prototype.$onInit=function(){this.instance=new a.TileDebug(this),this._register(this.instance)},e.prototype.ngOnChanges=function(t){var e={};if(this.instance)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n].currentValue)},e}(s.SourceComponent);e.SourceTiledebugComponent=c;var h={bindings:i(i({},s.sourceComponentConfig.bindings),{projection:"<?",tileGrid:"<?",wrapX:"<?",zDirection:"<?"}),require:{host:"^"+u.aolLayerTile.name},controller:[c]};e.aolSourceTiledebug=i({name:"aolSourceTiledebug"},h)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=n(20),s=n(35),a=n(18),u=n(2),c=function(){function t(){this.srid="EPSG:4326"}return t.prototype.$onInit=function(){if(this.geometryPointHost)this.host=this.geometryPointHost;else{if(!this.viewHost)throw new Error("aol-collection-coordinates must be a child of a geometry component");this.host=this.viewHost}this.$onChanges({})},t.prototype.$onChanges=function(t){var e,n,r;if(this.host&&o.isNumber(this.x)&&o.isNumber(this.y))switch(n=(e=this.map.instance.getView().getProjection())?e.getCode():"EPSG:3857",r=this.srid===n?[this.x,this.y]:s.transform([this.x,this.y],this.srid,n),this.host.componentType){case"geometry-point":this.host.instance.setCoordinates(r);break;case"view":this.host.instance.setCenter(r)}},t}();e.CoordinateComponent=c;var h={bindings:{x:"<",y:"<",srid:"<?"},require:{viewHost:"?^"+a.default.name,geometryPointHost:"?^"+i.aolGeometryPoint.name,map:"^"+u.default.name},controller:[c]};e.aolCoordinate=r({name:"aolCoordinate"},h);var l=function(){function t(){this.srid="EPSG:4326"}return t.prototype.$onInit=function(){if(this.geometryLinestring)this.host=this.geometryLinestring;else{if(!this.geometryPolygon)throw new Error("aol-collection-coordinates must be a child of a geometry component");this.host=this.geometryPolygon}this.$onChanges({})},t.prototype.$onChanges=function(t){var e,n,r;if(this.host&&this.coordinates instanceof Array)switch(e=this.map.instance.getView().getProjection(),n=e?e.getCode():"EPSG:3857",this.srid===n?r=this.coordinates:(r=[],this.coordinates.forEach(function(t){r.push(s.transform(t,this.srid,n))}.bind(this))),this.host.componentType){case"geometry-linestring":this.host.instance.setCoordinates(r);break;case"geometry-polygon":this.host.instance.setCoordinates([r]);break;default:throw new Error("aol-collection-coordinates' host is of unknown type: "+this.host.componentType)}},t}();e.CollectionCoordinatesComponent=l;var f={bindings:{coordinates:"<",srid:"<?"},require:{geometryPolygon:"?^"+i.aolGeometryPolygon.name,geometryLinestring:"?^"+i.aolGeometryLinestring.name,map:"^"+u.default.name},controller:[l]};e.aolCollectionCoordinates=r({name:"aolCollectionCoordinates"},f)},function(t,e){t.exports=ol.proj},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(9)),r(n(37)),r(n(38)),r(n(17)),r(n(39)),r(n(22))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),i=n(9),s=n(17),a=function(){function t(){this.componentType="style-stroke"}return t.prototype.$onInit=function(){if(this.styleCircleHost)this.host=this.styleCircleHost;else{if(!this.styleHost)throw new Error("aol-style must be applied to a feature or a layer");this.host=this.styleHost}switch(this.instance=new o.Stroke(this),this.host.componentType){case"style":this.host.instance.setStroke(this.instance);break;case"style-circle":this.host.stroke=this.instance}},t.prototype.$onDestroy=function(){switch(this.host.componentType){case"style":this.host.instance.setStroke(null);break;case"style-circle":this.host.stroke=null,this.host.update()}},t.prototype.$onChanges=function(t){if(this.instance){for(var e in t)if(t.hasOwnProperty(e))switch(e){case"color":this.instance.setColor(t[e].currentValue);break;case"lineCap":this.instance.setLineCap(t[e].currentValue);break;case"lineDash":this.instance.setLineDash(t[e].currentValue);break;case"lineDashOffset":this.instance.setLineDashOffset(t[e].currentValue);break;case"lineJoin":this.instance.setLineJoin(t[e].currentValue);break;case"miterLimit":this.instance.setMiterLimit(t[e].currentValue);break;case"width":this.instance.setWidth(t[e].currentValue)}this.host.update()}},t}();e.StrokeComponent=a;var u={bindings:{color:"<?",lineCap:"<?",lineJoin:"<?",lineDash:"<?",lineDashOffset:"<?",miterLimit:"<?",width:"<?"},require:{styleHost:"?^"+i.aolStyle.name,styleCircleHost:"?^"+s.aolStyleCircle.name},controller:[a]};e.aolStyleStroke=r({name:"aolStyleStroke"},u)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=n(10),s=n(17),a=n(22),u=function(){function t(){this.componentType="fill"}return t.prototype.$onInit=function(){if(this.styleTextHost)this.host=this.styleTextHost;else if(this.styleCircleHost)this.host=this.styleCircleHost;else{if(!this.styleHost)throw new Error("aol-style-fill must be applied to a Style or styleCircleHost or StyleText component");this.host=this.styleHost}switch(this.instance=new i.Fill(this),this.host.componentType){case"style":this.host.instance.setFill(this.instance);break;case"style-circle":this.host.fill=this.instance,this.host.update();break;case"style-text":this.host.instance.setFill(this.instance)}},t.prototype.$onDestroy=function(){switch(this.host.componentType){case"style":this.host.instance.setFill(null);break;case"style-circle":this.host.fill=this.instance,this.host.update();break;case"style-text":this.host.instance.setFill(null)}},t.prototype.$onChanges=function(t){if(this.instance)switch(this.instance=new i.Fill({color:t.color.currentValue}),this.host.componentType){case"style":this.host.instance.setStroke(this.instance);break;case"style-circle":this.host.fill=this.instance,this.host.update();break;case"style-text":this.host.instance.setFill(this.instance)}},t}();e.FillComponent=u;var c={bindings:{color:"<?"},require:{styleHost:"?^"+o.aolStyle.name,styleCircleHost:"?^"+s.aolStyleCircle.name,styleTextHost:"?^"+a.aolStyleText.name},controller:[u]};e.aolStyleFill=r({name:"aolStyleFill"},c)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=n(10),s=function(){function t(){this.componentType="style-icon"}return t.prototype.$onInit=function(){if(!this.host)throw new Error("aol-style-icon must be applied to a style component");this.instance=new i.Icon(this),this.host.instance.setImage(this.instance)},t.prototype.$onDestroy=function(){this.host.instance.setImage(null)},t.prototype.$onChanges=function(t){this.instance&&(t.opacity&&this.instance.setOpacity(t.opacity.currentValue),t.rotation&&this.instance.setRotation(t.rotation.currentValue),t.scale&&this.instance.setScale(t.scale.currentValue),t.src&&(this.instance=new i.Icon(this),this.host.instance.setImage(this.instance)),this.host.update())},t}();e.styleIconComponent=s;var a={bindings:{anchor:"<?",anchorOrigin:"<?",anchorXUnits:"<?",anchorYUnits:"<?",color:"<?",crossOrigin:"<?",img:"<?",offset:"<?",offsetOrigin:"<?",opacity:"<?",scale:"<?",rotateWithView:"<?",rotation:"<?",size:"<?",imgSize:"<?",src:"<?"},require:{host:"?^"+o.aolStyle.name},controller:[s]};e.aolStyleIcon=r({name:"aolStyleIcon"},a)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),i=n(2),s=function(){function t(t){this.componentType="overlay",this.$element=t}return t.prototype.$onInit=function(){this.$element[0]&&(this.element=this.$element[0],this.instance=new o.Overlay(this),this.host.instance.addOverlay(this.instance))},t.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)e[n]=t[n].currentValue;this.instance.setProperties(e,!1)}},t.prototype.$onDestroy=function(){this.instance&&this.host.instance.removeOverlay(this.instance)},t}();e.OverlayComponent=s;var a={bindings:{id:"<?",element:"<?",offset:"<?",position:"<?",positioning:"<?",stopEvent:"<?",insertFirst:"<?",autoPan:"<?",autoPanAnimation:"<?",autoPanMargin:"<?",className:"<"},require:{host:"^"+i.default.name},controller:["$element",s]};e.aolOverlay=r({name:"aolOverlay"},a)},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(42)),r(n(43)),r(n(44)),r(n(47))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),i=n(2),s=function(){function t(){}return t.prototype.$onInit=function(){var t=this;this.instance=o.defaults(this),this.instance.forEach((function(e){return t.host.instance.addInteraction(e)}))},t.prototype.$onDestroy=function(){var t=this;this.instance.forEach((function(e){return t.host.instance.removeInteraction(e)}))},t}();e.DefaultInteractionComponent=s;var a={bindings:{altShiftDragRotate:"<?",onFocusOnly:"<?",doubleClickZoom:"<?",keyboard:"<?",mouseWheelZoom:"<?",shiftDragZoom:"<?",dragPan:"<?",pinchRotate:"<?",pinchZoom:"<?",zoomDelta:"<?",zoomDuration:"<"},require:{host:"^"+i.default.name},controller:["$element",s]};e.aolInteractionDefaults=r({name:"aolInteractionDefaults"},a)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=n(2),s=n(12),a=function(){function t(){this.onModifyEnd=o.noop,this.onModifyStart=o.noop,this.onChange=o.noop,this.onChangeActive=o.noop,this.onPropertyChange=o.noop}return t.prototype.$onInit=function(){var t=this;this.source||this.features?(this.instance=new s.Modify(this),this.instance.on("change",(function(e){return t.onChange({event:e})})),this.instance.on("change:active",(function(e){return t.onChangeActive({event:e})})),this.instance.on("propertychange",(function(e){return t.onPropertyChange({event:e})})),this.instance.on("modifyend",(function(e){return t.onModifyEnd({event:e})})),this.instance.on("modifystart",(function(e){return t.onModifyStart({event:e})})),this.host.instance.addInteraction(this.instance)):console.error("The modify interaction requires features or a source")},t.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)if(t.hasOwnProperty(n))switch(n){case"source":this.$onDestroy(),this.$onInit();break;default:e[n]=t[n].currentValue}this.instance.setProperties(e,!1)}else this.$onInit()},t.prototype.$onDestroy=function(){this.host.instance.removeInteraction(this.instance)},t}();e.ModifyInteractionComponent=a;var u={bindings:{condition:"<",deleteCondition:"<?",insertVertexCondition:"<?",pixelTolerance:"<?",style:"<?",source:"<?",features:"<?",wrapX:"<?"},require:{host:"^"+i.default.name},controller:["$element",a]};e.aolInteractionModify=r({name:"aolInteractionModify"},u)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),a=n(12),u=n(2),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSelect=s.noop,e.onChange=s.noop,e.onPropertyChange=s.noop,e}return o(e,t),e.prototype.$onInit=function(){var e=this;this.host?(t.prototype.initCondition.call(this),this.instance=new a.Select(this),this.instance.on("select",(function(t){return e.onSelect({event:t})})),this.instance.on("change",(function(t){return e.onChange({event:t})})),this.instance.on("propertychange",(function(t){return e.onPropertyChange({event:t})})),this.host.instance.addInteraction(this.instance)):console.error("The select interaction requires map component")},e.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n].currentValue);this.instance.setProperties(e,!1)}},e.prototype.$onDestroy=function(){this.host.instance.removeInteraction(this.instance)},e}(n(45).SelectInteractionExtend);e.SelectInteractionComponent=c;var h={bindings:{addCondition:"<",condition:"<?",layers:"<?",style:"<?",removeCondition:"<?",toggleCondition:"<?",multi:"<?",features:"<?",filter:"<?",wrapX:"<?",onChange:"&?",onSelect:"&?",onPropertyChange:"&?"},require:{host:"^"+u.default.name},controller:["$element",c]};e.aolInteractionSelect=i({name:"aolInteractionSelect"},h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(46),i=function(){function t(){}return t.prototype.initCondition=function(){var t=this.condition;if("function"==typeof t)return t;switch(t){case"altKeyOnly":this.condition=o.altKeyOnly;break;case"altShiftKeysOnly":this.condition=o.altShiftKeysOnly;break;case"click":this.condition=o.click;break;case"doubleClick":this.condition=o.doubleClick;break;case"focus":this.condition=o.focus;break;case"mouseActionButton":this.condition=o.mouseActionButton;break;case"mouseOnly":this.condition=o.mouseOnly;break;case"noModifierKeys":this.condition=o.noModifierKeys;break;case"penOnly":this.condition=o.penOnly;break;case"platformModifierKeyOnly":this.condition=o.platformModifierKeyOnly;break;case"pointerMove":this.condition=o.pointerMove;break;case"primaryAction":this.condition=o.primaryAction;break;case"shiftKeyOnly":this.condition=o.shiftKeyOnly;break;case"singleClick":this.condition=o.singleClick;break;case"targetNotEditable":this.condition=o.targetNotEditable;break;case"touchOnly":this.condition=o.touchOnly;break;default:this.condition=o.click}},t}();e.SelectInteractionExtend=i,function(t){t.altKeyOnly="altKeyOnly",t.altShiftKeysOnly="altShiftKeysOnly",t.click="click",t.doubleClick="doubleClick",t.focus="focus",t.mouseActionButton="mouseActionButton",t.mouseOnly="mouseOnly",t.noModifierKeys="noModifierKeys",t.penOnly="penOnly",t.platformModifierKeyOnly="platformModifierKeyOnly",t.pointerMove="pointerMove",t.primaryAction="primaryAction",t.shiftKeyOnly="shiftKeyOnly",t.singleClick="singleClick",t.targetNotEditable="targetNotEditable",t.touchOnly="touchOnly"}(r||(r={}))},function(t,e){t.exports=ol.events.condition},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),a=n(12),u=n(2),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onAddFeatures=s.noop,e.onChange=s.noop,e.onPropertyChange=s.noop,e}return o(e,t),e.prototype.$onInit=function(){var e=this;this.host?(t.prototype.decorate.call(this,this),this.instance=new a.DragAndDrop(this),this.instance.on("addfeatures",(function(t){return e.onAddFeatures({event:t})})),this.instance.on("change",(function(t){return e.onChange({event:t})})),this.instance.on("propertychange",(function(t){return e.onPropertyChange({event:t})})),this.host.instance.addInteraction(this.instance)):console.error("The DragAndDrop interaction requires map component")},e.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)if(t.hasOwnProperty(n))switch(n){case"source":this.$onDestroy(),this.$onInit();break;default:e[n]=t[n].currentValue}this.instance.setProperties(e,!1)}},e.prototype.$onDestroy=function(){this.host.instance.removeInteraction(this.instance)},e}(n(48).DraganddropInteractionExtend);e.DraganddropInteractionComponent=c;var h={bindings:{formatConstructors:"<",source:"<?",projection:"<?",target:"<?",onChange:"&?",onAddFeatures:"&?",onPropertyChange:"&?"},require:{host:"^"+u.default.name},controller:[c]};e.aolInteractionDraganddrop=i({name:"aolInteractionDraganddrop"},h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(49),o=function(){function t(){this.defaultFormat={GPX:r.GPX,GeoJSON:r.GeoJSON,IGC:r.IGC,KML:r.KML,TopoJSON:r.TopoJSON,EsriJSON:r.EsriJSON,GML:r.GML,IIIFInfo:r.IIIFInfo,MVT:r.MVT,OWS:r.OWS,Polyline:r.Polyline,WFS:r.WFS,WKT:r.WKT,WMSCapabilities:r.WMSCapabilities,WMSGetFeatureInfo:r.WMSGetFeatureInfo,WMTSCapabilities:r.WMTSCapabilities}}return t.prototype.decorate=function(t){t.formatConstructors&&(t.formatConstructors=this.getFormat(t.formatConstructors))},t.prototype.getFormat=function(t){var e=this;return t.map((function(t){if("function"==typeof t)return t;var n=e.defaultFormat[t];if(n)return n;throw new Error("DragandDrop不存在当前FeatureFormat")}))},t}();e.DraganddropInteractionExtend=o},function(t,e){t.exports=ol.format},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),a=n(12),u=n(2),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onChange=s.noop,e.onChangeActive=s.noop,e.onDrawEnd=s.noop,e.onDrawStart=s.noop,e.onPropertyChange=s.noop,e}return o(e,t),e.prototype.$onInit=function(){var e=this;t.prototype.init.call(this,this.type),this.instance=new a.Draw(this),this.instance.on("change",(function(t){return e.onChange({event:t})})),this.instance.on("change:active",(function(t){return e.onChangeActive({event:t})})),this.instance.on("drawend",(function(t){return e.onDrawEnd({event:t})})),this.instance.on("drawstart",(function(t){return e.onDrawStart({event:t})})),this.instance.on("propertychange",(function(t){return e.onPropertyChange({event:t})})),this.host.instance.addInteraction(this.instance)},e.prototype.$onChanges=function(t){var e={};if(this.instance){for(var n in t)if(t.hasOwnProperty(n))switch(n){case"source":this.$onDestroy(),this.$onInit();break;default:e[n]=t[n].currentValue}this.instance.setProperties(e,!1)}},e.prototype.$onDestroy=function(){this.host.instance.removeInteraction(this.instance)},e}(n(51).DrawInteractionExtend);e.DrawInteractionComponent=c;var h={bindings:{type:"<",clickTolerance:"<?",features:"<?",source:"<?",dragVertexDelay:"<?",snapTolerance:"<?",stopClick:"<?",maxPoints:"<?",minPoints:"<?",finishCondition:"<?",style:"<?",geometryFunction:"<?",geometryName:"<?",condition:"<?",freehand:"<?",freehandCondition:"<?",wrapX:"<?",onChange:"&?",onChangeActive:"&?",onDrawEnd:"&?",onDrawStart:"&?",onPropertyChange:"&?"},require:{host:"^"+u.default.name},controller:["$element",c]};e.aolInteractionDraw=i({name:"aolInteractionDraw"},h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(21),o=function(){function t(){}return t.prototype.init=function(t){switch(t){case"Rectangle":this.__createRectangleParams();break;default:this.type=t}},t.prototype.__createRectangleParams=function(){this.maxPoints=2,this.type="LineString",this.geometryFunction=function(t,e){e||(e=new r.Polygon([]));var n=t[0],o=t[1];return e.setCoordinates([[n,[n[0],o[1]],o,[o[0],n[1]],n]]),e}},t}();e.DrawInteractionExtend=o},function(t,e,n){"use strict";n.r(e);var r="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])}return n};function o(t){for(var e in t)delete t[e]}"function"==typeof Object.values&&Object.values;var i,s=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function a(t,e){for(var n=s.length,r=0;r<n;++r)try{var o=t.getContext(s[r],e);if(o)return o}catch(t){}return null}var u=n(1),c=35044;function h(t){switch(t){case 34962:return Float32Array;case 34963:return Uint32Array;default:return Float32Array}}var l=function(){function t(t,e){this.array=null,this.type=t,Object(u.a)(34962===t||34963===t,62),this.usage=void 0!==e?e:c}return t.prototype.ofSize=function(t){this.array=new(h(this.type))(t)},t.prototype.fromArray=function(t){this.array=h(this.type).from(t)},t.prototype.fromArrayBuffer=function(t){this.array=new(h(this.type))(t)},t.prototype.getType=function(){return this.type},t.prototype.getArray=function(){return this.array},t.prototype.getUsage=function(){return this.usage},t.prototype.getSize=function(){return this.array?this.array.length:0},t}(),f=n(0),p=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}(),y="webglcontextlost",d="webglcontextrestored",g=new Array(6);function _(t){return v(t,1,0,0,1,0,0)}function m(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],s=t[4],a=t[5],u=e[0],c=e[1],h=e[2],l=e[3],f=e[4],p=e[5];return t[0]=n*u+o*c,t[1]=r*u+i*c,t[2]=n*h+o*l,t[3]=r*h+i*l,t[4]=n*f+o*p+s,t[5]=r*f+i*p+a,t}function v(t,e,n,r,o,i,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=s,t}function b(t,e){var n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function O(t,e,n,r,o,i,s,a){var u=Math.sin(i),c=Math.cos(i);return t[0]=r*c,t[1]=o*u,t[2]=-r*u,t[3]=o*c,t[4]=s*r*c-a*r*u+e,t[5]=s*o*u+a*o*c+n,t}function x(t,e){var n,r=(n=e)[0]*n[3]-n[1]*n[2];Object(u.a)(0!==r,32);var o=e[0],i=e[1],s=e[2],a=e[3],c=e[4],h=e[5];return t[0]=a/r,t[1]=-i/r,t[2]=-s/r,t[3]=o/r,t[4]=(s*h-a*c)/r,t[5]=-(o*h-i*c)/r,t}function C(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}var S,T=function(){function t(t){this.gl_=t.webGlContext;var e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer();var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,t.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),e.compileShader(n);var r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,t.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n"),e.compileShader(r),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,n),e.attachShader(this.renderTargetProgram_,r),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(function(n){this.uniforms_.push({value:t.uniforms[n],location:e.getUniformLocation(this.renderTargetProgram_,n)})}.bind(this))}return t.prototype.getGL=function(){return this.gl_},t.prototype.init=function(t){var e=this.getGL(),n=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;var r=e.RGBA,o=e.RGBA,i=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,0,r,n[0],n[1],0,o,i,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}},t.prototype.apply=function(t,e){var n=this.getGL(),r=t.size;n.bindFramebuffer(n.FRAMEBUFFER,e?e.getFrameBuffer():null),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.useProgram(this.renderTargetProgram_),n.enableVertexAttribArray(this.renderTargetAttribLocation_),n.vertexAttribPointer(this.renderTargetAttribLocation_,2,n.FLOAT,!1,0,0),n.uniform2f(this.renderTargetUniformLocation_,r[0],r[1]),n.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(t),n.drawArrays(n.TRIANGLES,0,6)},t.prototype.getFrameBuffer=function(){return this.frameBuffer_},t.prototype.applyUniforms=function(t){var e,n=this.getGL(),r=1;this.uniforms_.forEach((function(o){if((e="function"==typeof o.value?o.value(t):o.value)instanceof HTMLCanvasElement||e instanceof ImageData)o.texture||(o.texture=n.createTexture()),n.activeTexture(n["TEXTURE"+r]),n.bindTexture(n.TEXTURE_2D,o.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),e instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,e.width,e.height,0,n.UNSIGNED_BYTE,new Uint8Array(e.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.uniform1i(o.location,r++);else if(Array.isArray(e))switch(e.length){case 2:return void n.uniform2f(o.location,e[0],e[1]);case 3:return void n.uniform3f(o.location,e[0],e[1],e[2]);case 4:return void n.uniform4f(o.location,e[0],e[1],e[2],e[3]);default:return}else"number"==typeof e&&n.uniform1f(o.location,e)}))},t}(),w=n(3),E=(S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P="u_projectionMatrix",R="u_offsetScaleMatrix",A="u_offsetRotateMatrix",I="u_time",L="u_zoom",j="u_resolution",D={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};function M(t){switch(t){case D.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case D.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case D.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case D.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var F=function(t){function e(e){var n=t.call(this)||this,r=e||{};n.boundHandleWebGLContextLost_=n.handleWebGLContextLost.bind(n),n.boundHandleWebGLContextRestored_=n.handleWebGLContextRestored.bind(n),n.canvas_=document.createElement("canvas"),n.canvas_.style.position="absolute",n.canvas_.style.left="0",n.gl_=a(n.canvas_);var o=n.getGL();if(n.bufferCache_={},n.currentProgram_=null,Object(u.a)(Object(w.b)(function(){if(!i){var t=a(document.createElement("canvas"));t&&(i=t.getSupportedExtensions())}return i}(),"OES_element_index_uint"),63),o.getExtension("OES_element_index_uint"),n.canvas_.addEventListener(y,n.boundHandleWebGLContextLost_),n.canvas_.addEventListener(d,n.boundHandleWebGLContextRestored_),n.offsetRotateMatrix_=[1,0,0,1,0,0],n.offsetScaleMatrix_=[1,0,0,1,0,0],n.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n.uniformLocations_={},n.attribLocations_={},n.uniforms_=[],r.uniforms)for(var s in r.uniforms)n.uniforms_.push({name:s,value:r.uniforms[s]});return n.postProcessPasses_=r.postProcesses?r.postProcesses.map((function(t){return new T({webGlContext:o,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})})):[new T({webGlContext:o})],n.shaderCompileErrors_=null,n.startTime_=Date.now(),n}return E(e,t),e.prototype.bindBuffer=function(t){var e=this.getGL(),n=Object(f.c)(t),r=this.bufferCache_[n];r||(r={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[n]=r);e.bindBuffer(t.getType(),r.webGlBuffer)},e.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var e=this.getGL(),n=Object(f.c)(t),r=this.bufferCache_[n];e.isContextLost()||e.deleteBuffer(r.buffer),delete this.bufferCache_[n]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(y,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(d,this.boundHandleWebGLContextRestored_)},e.prototype.prepareDraw=function(t){var e=this.getGL(),n=this.getCanvas(),r=t.size,o=t.pixelRatio;n.width=r[0]*o,n.height=r[1]*o,n.style.width=r[0]+"px",n.style.height=r[1]+"px",e.useProgram(this.currentProgram_);for(var i=this.postProcessPasses_.length-1;i>=0;i--)this.postProcessPasses_[i].init(t);e.bindTexture(e.TEXTURE_2D,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,e,n){var r=this.getGL(),o=e.getSize();r.bindFramebuffer(r.FRAMEBUFFER,e.getFramebuffer()),r.viewport(0,0,o[0],o[1]),r.bindTexture(r.TEXTURE_2D,e.getTexture()),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,n?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,e){var n=this.getGL(),r=n.UNSIGNED_INT,o=e-t,i=4*t;n.drawElements(n.TRIANGLES,o,r,i)},e.prototype.finalizeDraw=function(t){for(var e=0;e<this.postProcessPasses_.length;e++)this.postProcessPasses_[e].apply(t,this.postProcessPasses_[e+1]||null)},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var e,n,r,o=t.size,i=t.viewState.rotation,s=_(this.offsetScaleMatrix_);e=s,n=2/o[0],r=2/o[1],m(e,v(g,n,0,0,r,0,0));var a=_(this.offsetRotateMatrix_);0!==i&&function(t,e){var n=Math.cos(e),r=Math.sin(e);m(t,v(g,n,r,-r,n,0,0))}(a,-i),this.setUniformMatrixValue(R,C(this.tmpMat4_,s)),this.setUniformMatrixValue(A,C(this.tmpMat4_,a)),this.setUniformFloatValue(I,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(L,t.viewState.zoom),this.setUniformFloatValue(j,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var e,n=this.getGL(),r=0;this.uniforms_.forEach(function(o){if((e="function"==typeof o.value?o.value(t):o.value)instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData)o.texture||(o.texture=n.createTexture()),n.activeTexture(n["TEXTURE"+r]),n.bindTexture(n.TEXTURE_2D,o.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(!(e instanceof HTMLImageElement)||e.complete)&&n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.uniform1i(this.getUniformLocation(o.name),r++);else if(Array.isArray(e)&&6===e.length)this.setUniformMatrixValue(o.name,C(this.tmpMat4_,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:return void n.uniform2f(this.getUniformLocation(o.name),e[0],e[1]);case 3:return void n.uniform3f(this.getUniformLocation(o.name),e[0],e[1],e[2]);case 4:return void n.uniform4f(this.getUniformLocation(o.name),e[0],e[1],e[2],e[3]);default:return}else"number"==typeof e&&n.uniform1f(this.getUniformLocation(o.name),e)}.bind(this))},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0)},e.prototype.compileShader=function(t,e){var n=this.getGL(),r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r},e.prototype.getProgram=function(t,e){var n=this.getGL(),r=this.compileShader(t,n.FRAGMENT_SHADER),o=this.compileShader(e,n.VERTEX_SHADER);this.shaderCompileErrors_=null,n.getShaderInfoLog(r)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+n.getShaderInfoLog(r)),n.getShaderInfoLog(o)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+n.getShaderInfoLog(o));var i=n.createProgram();return n.attachShader(i,r),n.attachShader(i,o),n.linkProgram(i),i},e.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},e.prototype.getUniformLocation=function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,e){var n=t.size,r=t.viewState.rotation,o=t.viewState.resolution,i=t.viewState.center;return _(e),O(e,0,0,2/(o*n[0]),2/(o*n[1]),-r,-i[0],-i[1]),e},e.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},e.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},e.prototype.enableAttributeArray_=function(t,e,n,r,o){var i=this.getAttributeLocation(t);i<0||(this.getGL().enableVertexAttribArray(i),this.getGL().vertexAttribPointer(i,e,n,!1,r,o))},e.prototype.enableAttributes=function(t){for(var e=function(t){for(var e=0,n=0;n<t.length;n++){var r=t[n];e+=r.size*M(r.type)}return e}(t),n=0,r=0;r<t.length;r++){var o=t[r];this.enableAttributeArray_(o.name,o.size,o.type||5126,e,n),n+=o.size*M(o.type)}},e.prototype.handleWebGLContextLost=function(){o(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,e,n){var r=this.getGL(),o=n||r.createTexture(),i=r.RGBA,s=r.RGBA,a=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,o),e?r.texImage2D(r.TEXTURE_2D,0,i,s,a,e):r.texImage2D(r.TEXTURE_2D,0,i,t[0],t[1],0,s,a,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),o},e}(p),z="Point",G=0,k=2,V=3;function U(t,e,n,r,o){if(r&&r!==t&&(n=n.bind(r)),o){var i=n;n=function(){t.removeEventListener(e,n),i.apply(this,arguments)}}var s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function B(t,e,n,r){return U(t,e,n,r,!0)}function X(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),o(t))}function $(){}var N=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),W=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(t){function e(e){var n=t.call(this)||this;return n.eventTarget_=e,n.pendingRemovals_={},n.dispatching_={},n.listeners_={},n}return W(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var n=this.listeners_[t];n||(n=[],this.listeners_[t]=n),-1===n.indexOf(e)&&n.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new N(t):t,n=e.type;e.target||(e.target=this.eventTarget_||this);var r,o=this.listeners_[n];if(o){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var i=0,s=o.length;i<s;++i)if(!1===o[i].call(this,e)||e.propagationStopped){r=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var a=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];a--;)this.removeEventListener(n,$);delete this.dispatching_[n]}return r}},e.prototype.disposeInternal=function(){o(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var r=n.indexOf(e);-1!==r&&(t in this.pendingRemovals_?(n[r]=$,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}},e}(p),Y="change",Z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var q=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return Z(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Y)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),o=0;o<n;++o)r[o]=U(this,t[o],e);return r}return U(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),o=0;o<n;++o)r[o]=B(this,t[o],e);return r}return B(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var n=0,r=t.length;n<r;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)},e}(H),K="undefined",J="ready",Q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tt=function(t){function e(e){var n=t.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=e,n}return Q(e,t),e.prototype.getFeatures=function(t){return Object(f.b)()},e.prototype.prepareFrame=function(t){return Object(f.b)()},e.prototype.renderFrame=function(t,e){return Object(f.b)()},e.prototype.loadedTileCallback=function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n},e.prototype.createLoadedTileFinder=function(t,e,n){return function(r,o){var i=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(e,r,o,i)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,o){},e.prototype.getDataAtPixel=function(t,e,n){return Object(f.b)()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===k&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=k&&e!=V&&t.addEventListener(Y,this.boundHandleImageChange_),e==G&&(t.load(),e=t.getState()),e==k},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==J&&t.changed()},e}(q),et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt="GENERATE_BUFFERS",rt=function(t){function e(e,n){var r=t.call(this,e)||this,o=n||{};return r.helper=new F({postProcesses:o.postProcesses,uniforms:o.uniforms}),r}return et(e,t),e.prototype.disposeInternal=function(){this.helper.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},e}(tt);var ot=rt,it=0,st=1,at=n(6),ut=new Blob(['var e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n="GENERATE_BUFFERS",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};'],{type:"application/javascript"}),ct=URL.createObjectURL(ut);var ht=new Uint8Array(4),lt=function(){function t(t,e){this.helper_=t;var n=t.getGL();this.texture_=n.createTexture(),this.framebuffer_=n.createFramebuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return t.prototype.setSize=function(t){Object(w.a)(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())},t.prototype.getSize=function(){return this.size_},t.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},t.prototype.readAll=function(){if(this.dataCacheDirty_){var t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},t.prototype.readPixel=function(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return ht[0]=0,ht[1]=0,ht[2]=0,ht[3]=0,ht;this.readAll();var n=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return ht[0]=this.data_[4*n],ht[1]=this.data_[4*n+1],ht[2]=this.data_[4*n+2],ht[3]=this.data_[4*n+3],ht},t.prototype.getTexture=function(){return this.texture_},t.prototype.getFramebuffer=function(){return this.framebuffer_},t.prototype.updateSize_=function(){var t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)},t}(),ft="propertychange",pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yt=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.key=n,o.oldValue=r,o}return pt(e,t),e}(N),dt=function(t){function e(e){var n=t.call(this)||this;return Object(f.c)(n),n.values_={},void 0!==e&&n.setProperties(e),n}return pt(e,t),e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return r({},this.values_)},e.prototype.notify=function(t,e){var n;n=_t(t),this.dispatchEvent(new yt(n,t,e)),n=ft,this.dispatchEvent(new yt(n,t,e))},e.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var r=this.values_[t];this.values_[t]=e,r!==e&&this.notify(t,r)}},e.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},e.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},e}(q),gt={};function _t(t){return gt.hasOwnProperty(t)?gt[t]:gt[t]="change:"+t}var mt=dt,vt="opacity",bt="visible",Ot="extent",xt="zIndex",Ct="maxResolution",St="minResolution",Tt="maxZoom",wt="minZoom",Et="source",Pt=n(4),Rt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(t){function e(e){var n=t.call(this)||this,o=r({},e);return o[vt]=void 0!==e.opacity?e.opacity:1,Object(u.a)("number"==typeof o[vt],64),o[bt]=void 0===e.visible||e.visible,o[xt]=e.zIndex,o[Ct]=void 0!==e.maxResolution?e.maxResolution:1/0,o[St]=void 0!==e.minResolution?e.minResolution:0,o[wt]=void 0!==e.minZoom?e.minZoom:-1/0,o[Tt]=void 0!==e.maxZoom?e.maxZoom:1/0,n.className_=void 0!==o.className?e.className:"ol-layer",delete o.className,n.setProperties(o),n.state_=null,n}return Rt(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=Object(Pt.a)(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n?n:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return Object(f.b)()},e.prototype.getLayerStatesArray=function(t){return Object(f.b)()},e.prototype.getExtent=function(){return this.get(Ot)},e.prototype.getMaxResolution=function(){return this.get(Ct)},e.prototype.getMinResolution=function(){return this.get(St)},e.prototype.getMinZoom=function(){return this.get(wt)},e.prototype.getMaxZoom=function(){return this.get(Tt)},e.prototype.getOpacity=function(){return this.get(vt)},e.prototype.getSourceState=function(){return Object(f.b)()},e.prototype.getVisible=function(){return this.get(bt)},e.prototype.getZIndex=function(){return this.get(xt)},e.prototype.setExtent=function(t){this.set(Ot,t)},e.prototype.setMaxResolution=function(t){this.set(Ct,t)},e.prototype.setMinResolution=function(t){this.set(St,t)},e.prototype.setMaxZoom=function(t){this.set(Tt,t)},e.prototype.setMinZoom=function(t){this.set(wt,t)},e.prototype.setOpacity=function(t){Object(u.a)("number"==typeof t,64),this.set(vt,t)},e.prototype.setVisible=function(t){this.set(bt,t)},e.prototype.setZIndex=function(t){this.set(xt,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(mt),It="precompose",Lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var jt=function(t){function e(e){var n=this,o=r({},e);delete o.source,(n=t.call(this,o)||this).mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,e.render&&(n.render=e.render),e.map&&n.setMap(e.map),n.addEventListener(_t(Et),n.handleSourcePropertyChange_);var i=e.source?e.source:null;return n.setSource(i),n}return Lt(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Et)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():K},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(X(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=U(t,Y,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},e.prototype.render=function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(X(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(X(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=U(t,It,(function(t){var e=t.frameState.layerStatesArray,n=this.getLayerState(!1);Object(u.a)(!e.some((function(t){return t.layer===n.layer})),67),e.push(n)}),this),this.mapRenderKey_=U(this,Y,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Et,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.setSource(null),t.prototype.disposeInternal.call(this)},e}(At),Dt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Mt=/^([a-z]*)$|^hsla?\(.*\)$/i;function Ft(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var n=getComputedStyle(e).color;return document.body.removeChild(e),n}return""}var zt,Gt,kt=(zt={},Gt=0,function(t){var e;if(zt.hasOwnProperty(t))e=zt[t];else{if(Gt>=1024){var n=0;for(var r in zt)0==(3&n++)&&(delete zt[r],--Gt)}e=function(t){var e,n,r,o,i;if(Mt.exec(t)&&(t=Ft(t)),Dt.exec(t)){var s=t.length-1,a=void 0;a=s<=4?1:2;var c=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),n=parseInt(t.substr(1+1*a,a),16),r=parseInt(t.substr(1+2*a,a),16),o=c?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,n=(n<<4)+n,r=(r<<4)+r,c&&(o=(o<<4)+o)),i=[e,n,r,o/255]}else 0==t.indexOf("rgba(")?Ut(i=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((i=t.slice(4,-1).split(",").map(Number)).push(1),Ut(i)):Object(u.a)(!1,14);return i}(t),zt[t]=e,++Gt}return e});function Vt(t){return Array.isArray(t)?t:kt(t)}function Ut(t){return t[0]=Object(Pt.a)(t[0]+.5|0,0,255),t[1]=Object(Pt.a)(t[1]+.5|0,0,255),t[2]=Object(Pt.a)(t[2]+.5|0,0,255),t[3]=Object(Pt.a)(t[3],0,1),t}function Bt(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+n+","+r+","+(void 0===t[3]?1:t[3])+")"}function Xt(t){return Array.isArray(t)?Bt(t):t}function $t(t,e,n){var r=n&&n.length?n.shift():document.createElement("canvas");return t&&(r.width=t),e&&(r.height=e),r.getContext("2d")}var Nt=function(){var t,e={};return function(n){if(t||(t=document.createElement("div").style),!(n in e)){t.font=n;var r=t.fontFamily,o=t.fontWeight,i=t.fontStyle;if(t.font="",!r)return null;var s=r.split(/,\s?/);e[n]={families:s,weight:o,style:i}}return e[n]}}(),Wt=new mt;(new H).setSize=function(){console.warn("labelCache is deprecated.")};var Ht,Yt,Zt,qt=null,Kt={};(function(){var t,e,n=["monospace","serif"],r=n.length,i="wmytzilWMYTZIL@#/&?$%10";function s(t,o,s){for(var a=!0,u=0;u<r;++u){var c=n[u];if(e=Jt(t+" "+o+" 32px "+c,i),s!=c){var h=Jt(t+" "+o+" 32px "+s+","+c,i);a=a&&h!=e}}return!!a}function a(){for(var e=!0,n=Wt.getKeys(),r=0,i=n.length;r<i;++r){var a=n[r];Wt.get(a)<100&&(s.apply(this,a.split("\n"))?(o(Kt),qt=null,Ht=void 0,Wt.set(a,100)):(Wt.set(a,Wt.get(a)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}})(),Zt=Kt;function Jt(t,e){return qt||(qt=$t(1,1)),t!=Ht&&(qt.font=t,Ht=qt.font),qt.measureText(e).width}var Qt=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.displacement_=t.displacement}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return Object(f.b)()},t.prototype.getImage=function(t){return Object(f.b)()},t.prototype.getHitDetectionImage=function(t){return Object(f.b)()},t.prototype.getImageState=function(){return Object(f.b)()},t.prototype.getImageSize=function(){return Object(f.b)()},t.prototype.getHitDetectionImageSize=function(){return Object(f.b)()},t.prototype.getOrigin=function(){return Object(f.b)()},t.prototype.getSize=function(){return Object(f.b)()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){Object(f.b)()},t.prototype.load=function(){Object(f.b)()},t.prototype.unlistenImageChange=function(t){Object(f.b)()},t}(),te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(t){function e(e){var n=this,r=void 0!==e.rotateWithView&&e.rotateWithView;return(n=t.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==e.rotation?e.rotation:0,scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this).canvas_=null,n.hitDetectionCanvas_=null,n.fill_=void 0!==e.fill?e.fill:null,n.origin_=[0,0],n.points_=e.points,n.radius_=void 0!==e.radius?e.radius:e.radius1,n.radius2_=e.radius2,n.angle_=void 0!==e.angle?e.angle:0,n.stroke_=void 0!==e.stroke?e.stroke:null,n.anchor_=null,n.size_=null,n.imageSize_=null,n.hitDetectionImageSize_=null,n.render(),n}return te(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return k},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.render=function(){var t,e="round",n="round",r=0,o=null,i=0,s=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=Xt(t),void 0===(s=this.stroke_.getWidth())&&(s=1),o=this.stroke_.getLineDash(),i=this.stroke_.getLineDashOffset(),void 0===(n=this.stroke_.getLineJoin())&&(n="round"),void 0===(e=this.stroke_.getLineCap())&&(e="round"),void 0===(r=this.stroke_.getMiterLimit())&&(r=10));var a=2*(this.radius_+s)+1,u={strokeStyle:t,strokeWidth:s,size:a,lineCap:e,lineDash:o,lineDashOffset:i,lineJoin:n,miterLimit:r},c=$t(a,a);this.canvas_=c.canvas;var h=a=this.canvas_.width,l=this.getDisplacement();this.draw_(u,c,0,0),this.createHitDetectionCanvas_(u),this.anchor_=[a/2-l[0],a/2+l[1]],this.size_=[a,a],this.imageSize_=[h,h]},e.prototype.draw_=function(t,e,n,r){var o,i,s;e.setTransform(1,0,0,1,0,0),e.translate(n,r),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var u=void 0!==this.radius2_?this.radius2_:this.radius_;for(u!==this.radius_&&(a*=2),o=0;o<=a;o++)i=2*o*Math.PI/a-Math.PI/2+this.angle_,s=o%2==0?this.radius_:u,e.lineTo(t.size/2+s*Math.cos(i),t.size/2+s*Math.sin(i))}if(this.fill_){var c=this.fill_.getColor();null===c&&(c="#000"),e.fillStyle=Xt(c),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var e=this.fill_.getColor(),n=0;if("string"==typeof e&&(e=Vt(e)),null===e?n=1:Array.isArray(e)&&(n=4===e.length?e[3]:1),0===n){var r=$t(t.size,t.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(t,r,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,n,r){e.setTransform(1,0,0,1,0,0),e.translate(n,r),e.beginPath();var o=this.points_;if(o===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var i=void 0!==this.radius2_?this.radius2_:this.radius_;i!==this.radius_&&(o*=2);var s=void 0,a=void 0,u=void 0;for(s=0;s<=o;s++)u=2*s*Math.PI/o-Math.PI/2+this.angle_,a=s%2==0?this.radius_:i,e.lineTo(t.size/2+a*Math.cos(u),t.size/2+a*Math.sin(u))}e.fillStyle="#000",e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(Qt),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(t){function e(e){var n=e||{};return t.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,displacement:void 0!==n.displacement?n.displacement:[0,0]})||this}return ne(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(ee),oe=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),ie=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),se=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=ce,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=ce,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var ae=null;function ue(t,e){if(!ae){var n=new oe({color:"rgba(255,255,255,0.4)"}),r=new ie({color:"#3399CC",width:1.25});ae=[new se({image:new re({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return ae}function ce(t){return t.getGeometry()}var he=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),le="renderOrder",fe=function(t){function e(e){var n=this,o=e||{},i=r({},o);return delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,(n=t.call(this,i)||this).declutter_=void 0!==o.declutter&&o.declutter,n.renderBuffer_=void 0!==o.renderBuffer?o.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(o.style),n.updateWhileAnimating_=void 0!==o.updateWhileAnimating&&o.updateWhileAnimating,n.updateWhileInteracting_=void 0!==o.updateWhileInteracting&&o.updateWhileInteracting,n}return he(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(le)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(le,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:ue,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var n;if(Array.isArray(t))n=t;else Object(u.a)("function"==typeof t.getZIndex,41),n=[t];e=function(){return n}}return e}(this.style_),this.changed()},e}(jt),pe="addfeature",ye="changefeature",de="removefeature",ge=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_e=function(t){function e(e,n){var r=this,o=n.uniforms||{},i=[1,0,0,1,0,0];o[P]=i,(r=t.call(this,e,{uniforms:o,postProcesses:n.postProcesses})||this).sourceRevision_=-1,r.verticesBuffer_=new l(34962,35048),r.hitVerticesBuffer_=new l(34962,35048),r.indicesBuffer_=new l(34963,35048),r.program_=r.helper.getProgram(n.fragmentShader,n.vertexShader),r.hitDetectionEnabled_=!(!n.hitFragmentShader||!n.hitVertexShader),r.hitProgram_=r.hitDetectionEnabled_&&r.helper.getProgram(n.hitFragmentShader,n.hitVertexShader);var s=n.attributes?n.attributes.map((function(t){return{name:"a_"+t.name,size:1,type:D.FLOAT}})):[];r.attributes=[{name:"a_position",size:2,type:D.FLOAT},{name:"a_index",size:1,type:D.FLOAT}].concat(s),r.hitDetectionAttributes=[{name:"a_position",size:2,type:D.FLOAT},{name:"a_index",size:1,type:D.FLOAT},{name:"a_hitColor",size:4,type:D.FLOAT},{name:"a_featureUid",size:1,type:D.FLOAT}].concat(s),r.customAttributes=n.attributes?n.attributes:[],r.previousExtent_=Object(at.b)(),r.currentTransform_=i,r.renderTransform_=[1,0,0,1,0,0],r.invertRenderTransform_=[1,0,0,1,0,0],r.renderInstructions_=new Float32Array(0),r.hitRenderInstructions_=new Float32Array(0),r.hitRenderTarget_=r.hitDetectionEnabled_&&new lt(r.helper),r.worker_=new Worker(ct),r.worker_.addEventListener("message",function(t){var e=t.data;if(e.type===nt){var n=e.projectionTransform;e.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(e.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(e.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(e.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=n,x(this.invertRenderTransform_,this.renderTransform_),e.hitDetection?this.hitRenderInstructions_=new Float32Array(t.data.renderInstructions):this.renderInstructions_=new Float32Array(t.data.renderInstructions),this.getLayer().changed()}}.bind(r)),r.featureCache_={},r.featureCount_=0;var a=r.getLayer().getSource();return r.sourceListenKeys_=[U(a,pe,r.handleSourceFeatureAdded_,r),U(a,ye,r.handleSourceFeatureChanged_,r),U(a,de,r.handleSourceFeatureDelete_,r)],a.forEachFeature(function(t){this.featureCache_[Object(f.c)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}.bind(r)),r}return ge(e,t),e.prototype.handleSourceFeatureAdded_=function(t){var e=t.feature;this.featureCache_[Object(f.c)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++},e.prototype.handleSourceFeatureChanged_=function(t){var e=t.feature;this.featureCache_[Object(f.c)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}},e.prototype.handleSourceFeatureDelete_=function(t){var e=t.feature;delete this.featureCache_[Object(f.c)(e)],this.featureCount_--},e.prototype.renderFrame=function(t){var e=this.indicesBuffer_.getSize();this.helper.drawElements(0,e),this.helper.finalizeDraw(t);var n=this.helper.getCanvas(),r=t.layerStatesArray[t.layerIndex].opacity;return r!==parseFloat(n.style.opacity)&&(n.style.opacity=r),this.hitDetectionEnabled_&&(this.renderHitDetection(t),this.hitRenderTarget_.clearCachedData()),n},e.prototype.prepareFrame=function(t){var e=this.getLayer(),n=e.getSource(),r=t.viewState,o=!t.viewHints[it]&&!t.viewHints[st],i=!Object(at.d)(this.previousExtent_,t.extent),s=this.sourceRevision_<n.getRevision();if(s&&(this.sourceRevision_=n.getRevision()),o&&(i||s)){var a=r.projection,u=r.resolution,c=e instanceof fe?e.getRenderBuffer():0,h=Object(at.a)(t.extent,c*u);n.loadFeatures(h,u,a),this.rebuildBuffers_(t),this.previousExtent_=t.extent.slice()}return this.helper.makeProjectionTransform(t,this.currentTransform_),m(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(t),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},e.prototype.rebuildBuffers_=function(t){var e=[1,0,0,1,0,0];this.helper.makeProjectionTransform(t,e);var n,r,o=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===o||(this.renderInstructions_=new Float32Array(o)),this.hitDetectionEnabled_){var i=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===i||(this.hitRenderInstructions_=new Float32Array(i))}var s,a,u,c=[],h=[],l=0,f=0;for(var p in this.featureCache_)if((r=(n=this.featureCache_[p]).geometry)&&r.getType()===z){c[0]=r.getFlatCoordinates()[0],c[1]=r.getFlatCoordinates()[1],b(e,c),a=f+6,u=void 0,(u=h||[])[0]=Math.floor(a/256/256/256)/255,u[1]=Math.floor(a/256/256)%256/255,u[2]=Math.floor(a/256)%256/255,u[3]=a%256/255,s=u,this.renderInstructions_[l++]=c[0],this.renderInstructions_[l++]=c[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[f++]=c[0],this.hitRenderInstructions_[f++]=c[1],this.hitRenderInstructions_[f++]=s[0],this.hitRenderInstructions_[f++]=s[1],this.hitRenderInstructions_[f++]=s[2],this.hitRenderInstructions_[f++]=s[3],this.hitRenderInstructions_[f++]=Number(p));for(var y=void 0,d=0;d<this.customAttributes.length;d++)y=this.customAttributes[d].callback(n.feature,n.properties),this.renderInstructions_[l++]=y,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[f++]=y)}var g={type:nt,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(g.projectionTransform=e,this.worker_.postMessage(g,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var _={type:nt,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};_.projectionTransform=e,_.hitDetection=!0,this.worker_.postMessage(_,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},e.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,o){if(Object(u.a)(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var i=b(e.coordinateToPixelTransform,t.slice()),s=this.hitRenderTarget_.readPixel(i[0]/2,i[1]/2),a=function(t){var e=0;return e+=Math.round(256*t[0]*256*256*255),e+=Math.round(256*t[1]*256*255),e+=Math.round(256*t[2]*255),e+=Math.round(255*t[3])}([s[0]/255,s[1]/255,s[2]/255,s[3]/255]),c=this.hitRenderInstructions_[a],h=Math.floor(c).toString(),l=this.getLayer().getSource().getFeatureByUid(h);return l?r(l,this.getLayer()):void 0}},e.prototype.renderHitDetection=function(t){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var e=this.indicesBuffer_.getSize();this.helper.drawElements(0,e)}},e.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(t){X(t)})),this.sourceListenKeys_=null,t.prototype.disposeInternal.call(this)},e}(ot),me=1,ve=2,be=4,Oe=8,xe=16,Ce=31,Se={};function Te(t){if("number"==typeof t)return me;if("boolean"==typeof t)return Oe;if("string"==typeof t)return e=t,Mt.test(e)&&(e=Ft(e)),Dt.test(e)||0===e.indexOf("rgba(")||0===e.indexOf("rgb(")?be|ve:ve;var e;if(!Array.isArray(t))throw new Error("Unhandled value type: "+JSON.stringify(t));var n=t;if(n.every((function(t){return"number"==typeof t})))return 3===n.length||4===n.length?be|xe:xe;if("string"!=typeof n[0])throw new Error("Expected an expression operator but received: "+JSON.stringify(n));var r=Se[n[0]];if(void 0===r)throw new Error("Unrecognized expression operator: "+JSON.stringify(n));return r.getReturnType(n.slice(1))}function we(t){var e=t.toString();return-1===e.indexOf(".")?e+".0":e}function Ee(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec"+t.length+"("+t.map(we).join(", ")+")"}function Pe(t,e){return void 0===t.stringLiteralsMap[e]&&(t.stringLiteralsMap[e]=Object.keys(t.stringLiteralsMap).length),t.stringLiteralsMap[e]}function Re(t,e,n){if(Array.isArray(e)&&"string"==typeof e[0]){var r=Se[e[0]];if(void 0===r)throw new Error("Unrecognized expression operator: "+JSON.stringify(e));return r.toGlsl(t,e.slice(1),n)}return(Te(e)&me)>0?we(e):(Te(e)&Oe)>0?e.toString():(Te(e)&ve)>0&&(void 0===n||n==ve)?function(t,e){return we(Pe(t,e))}(t,e.toString()):(Te(e)&be)>0&&(void 0===n||n==be)?((o=Vt(e).slice()).length<4&&o.push(1),Ee(o.map((function(t,e){return e<3?t/255:t})))):(Te(e)&xe)>0?Ee(e):void 0;var o}function Ae(t){if(!(Te(t)&me))throw new Error("A numeric value was expected, got "+JSON.stringify(t)+" instead")}function Ie(t){for(var e=0;e<t.length;e++)Ae(t[e])}function Le(t){if(!(Te(t)&ve))throw new Error("A string value was expected, got "+JSON.stringify(t)+" instead")}function je(t){if(!(Te(t)&Oe))throw new Error("A boolean value was expected, got "+JSON.stringify(t)+" instead")}function De(t,e){if(t.length!==e)throw new Error("Exactly "+e+" arguments were expected, got "+t.length+" instead")}function Me(t,e){if(t.length<e)throw new Error("At least "+e+" arguments were expected, got "+t.length+" instead")}function Fe(t,e){if(t.length>e)throw new Error("At most "+e+" arguments were expected, got "+t.length+" instead")}function ze(t){if(t.length%2!=0)throw new Error("An even amount of arguments was expected, got "+t+" instead")}function Ge(t,e){if(n=e,Math.log2(n)%1!=0)throw new Error("Could not infer only one type from the following expression: "+JSON.stringify(t));var n}function ke(t){return{getReturnType:function(t){return Oe},toGlsl:function(e,n){De(n,2);for(var r=Ce,o=0;o<n.length;o++)r&=Te(n[o]);if(0===r)throw new Error("All arguments should be of compatible type, got "+JSON.stringify(n)+" instead");return"("+Re(e,n[0],r)+" "+t+" "+Re(e,n[1],r)+")"}}}Se.get={getReturnType:function(t){return Ce},toGlsl:function(t,e){De(e,1),Le(e[0]);var n=e[0].toString();return-1===t.attributes.indexOf(n)&&t.attributes.push(n),(t.inFragmentShader?"v_":"a_")+n}},Se.var={getReturnType:function(t){return Ce},toGlsl:function(t,e){De(e,1),Le(e[0]);var n=e[0].toString();return-1===t.variables.indexOf(n)&&t.variables.push(n),"u_"+n}},Se.time={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,0),"u_time"}},Se.zoom={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,0),"u_zoom"}},Se.resolution={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,0),"u_resolution"}},Se["*"]={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" * "+Re(t,e[1])+")"}},Se["/"]={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" / "+Re(t,e[1])+")"}},Se["+"]={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" + "+Re(t,e[1])+")"}},Se["-"]={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" - "+Re(t,e[1])+")"}},Se.clamp={getReturnType:function(t){return me},toGlsl:function(t,e){De(e,3),Ie(e);var n=Re(t,e[1]),r=Re(t,e[2]);return"clamp("+Re(t,e[0])+", "+n+", "+r+")"}},Se["%"]={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,2),Ie(e),"mod("+Re(t,e[0])+", "+Re(t,e[1])+")"}},Se["^"]={getReturnType:function(t){return me},toGlsl:function(t,e){return De(e,2),Ie(e),"pow("+Re(t,e[0])+", "+Re(t,e[1])+")"}},Se[">"]={getReturnType:function(t){return Oe},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" > "+Re(t,e[1])+")"}},Se[">="]={getReturnType:function(t){return Oe},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" >= "+Re(t,e[1])+")"}},Se["<"]={getReturnType:function(t){return Oe},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" < "+Re(t,e[1])+")"}},Se["<="]={getReturnType:function(t){return Oe},toGlsl:function(t,e){return De(e,2),Ie(e),"("+Re(t,e[0])+" <= "+Re(t,e[1])+")"}},Se["=="]=ke("=="),Se["!="]=ke("!="),Se["!"]={getReturnType:function(t){return Oe},toGlsl:function(t,e){return De(e,1),je(e[0]),"(!"+Re(t,e[0])+")"}},Se.between={getReturnType:function(t){return Oe},toGlsl:function(t,e){De(e,3),Ie(e);var n=Re(t,e[1]),r=Re(t,e[2]),o=Re(t,e[0]);return"("+o+" >= "+n+" && "+o+" <= "+r+")"}},Se.array={getReturnType:function(t){return xe},toGlsl:function(t,e){Me(e,2),Fe(e,4),Ie(e);var n=e.map((function(e){return Re(t,e,me)}));return"vec"+e.length+"("+n.join(", ")+")"}},Se.color={getReturnType:function(t){return be},toGlsl:function(t,e){Me(e,3),Fe(e,4),Ie(e);var n=e;3===e.length&&n.push(1);var r=e.map((function(e,n){return Re(t,e,me)+(n<3?" / 255.0":"")}));return"vec"+e.length+"("+r.join(", ")+")"}},Se.interpolate={getReturnType:function(t){for(var e=be|me,n=3;n<t.length;n+=2)e&=Te(t[n]);return e},toGlsl:function(t,e,n){ze(e),Me(e,6);var r,o=e[0];switch(o[0]){case"linear":r=1;break;case"exponential":r=o[1];break;default:r=null}if(!r)throw new Error('Invalid interpolation type for "interpolate" operator, received: '+JSON.stringify(o));var i=void 0!==n?n:Ce,s=Se.interpolate.getReturnType(e)&i;Ge(e,s);for(var a=Re(t,e[1]),u=null,c=2;c<e.length-2;c+=2){var h=Re(t,e[c]),l=Re(t,e[c+1],s),f=Re(t,e[c+2]);u="mix("+(u||l)+", "+Re(t,e[c+3],s)+", pow(clamp(("+a+" - "+h+") / ("+f+" - "+h+"), 0.0, 1.0), "+we(r)+"))"}return u}},Se.match={getReturnType:function(t){for(var e=Ce,n=2;n<t.length;n+=2)e&=Te(t[n]);return e&=Te(t[t.length-1])},toGlsl:function(t,e,n){ze(e),Me(e,4);var r=void 0!==n?n:Ce,o=Se.match.getReturnType(e)&r;Ge(e,o);for(var i=Re(t,e[0]),s=Re(t,e[e.length-1],o),a=null,u=e.length-3;u>=1;u-=2){a="("+i+" == "+Re(t,e[u])+" ? "+Re(t,e[u+1],o)+" : "+(a||s)+")"}return a}},Se.case={getReturnType:function(t){for(var e=Ce,n=1;n<t.length;n+=2)e&=Te(t[n]);return e&=Te(t[t.length-1])},toGlsl:function(t,e,n){!function(t){if(t.length%2==0)throw new Error("An even amount of arguments was expected, got "+t+" instead")}(e),Me(e,3);var r=void 0!==n?n:Ce,o=Se.case.getReturnType(e)&r;Ge(e,o);for(var i=0;i<e.length-1;i+=2)je(e[i]);var s=Re(t,e[e.length-1],o),a=null;for(i=e.length-3;i>=0;i-=2){a="("+Re(t,e[i])+" ? "+Re(t,e[i+1],o)+" : "+(a||s)+")"}return a}};var Ve=function(){function t(){this.uniforms=[],this.attributes=[],this.varyings=[],this.sizeExpression="vec2(1.0)",this.rotationExpression="0.0",this.offsetExpression="vec2(0.0)",this.colorExpression="vec4(1.0)",this.texCoordExpression="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression="false",this.rotateWithView=!1}return t.prototype.addUniform=function(t){return this.uniforms.push(t),this},t.prototype.addAttribute=function(t){return this.attributes.push(t),this},t.prototype.addVarying=function(t,e,n){return this.varyings.push({name:t,type:e,expression:n}),this},t.prototype.setSizeExpression=function(t){return this.sizeExpression=t,this},t.prototype.setRotationExpression=function(t){return this.rotationExpression=t,this},t.prototype.setSymbolOffsetExpression=function(t){return this.offsetExpression=t,this},t.prototype.setColorExpression=function(t){return this.colorExpression=t,this},t.prototype.setTextureCoordinateExpression=function(t){return this.texCoordExpression=t,this},t.prototype.setFragmentDiscardExpression=function(t){return this.discardExpression=t,this},t.prototype.setSymbolRotateWithView=function(t){return this.rotateWithView=t,this},t.prototype.getSizeExpression=function(){return this.sizeExpression},t.prototype.getOffsetExpression=function(){return this.offsetExpression},t.prototype.getColorExpression=function(){return this.colorExpression},t.prototype.getTextureCoordinateExpression=function(){return this.texCoordExpression},t.prototype.getFragmentDiscardExpression=function(){return this.discardExpression},t.prototype.getSymbolVertexShader=function(t){var e=this.rotateWithView?"u_offsetScaleMatrix * u_offsetRotateMatrix":"u_offsetScaleMatrix",n=this.attributes,r=this.varyings;return t&&(n=n.concat("vec4 a_hitColor"),r=r.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),"precision mediump float;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\n"+this.uniforms.map((function(t){return"uniform "+t+";"})).join("\n")+"\nattribute vec2 a_position;\nattribute float a_index;\n"+n.map((function(t){return"attribute "+t+";"})).join("\n")+"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n"+r.map((function(t){return"varying "+t.type+" "+t.name+";"})).join("\n")+"\nvoid main(void) {\n  mat4 offsetMatrix = "+e+";\n  vec2 halfSize = "+this.sizeExpression+" * 0.5;\n  vec2 offset = "+this.offsetExpression+";\n  float angle = "+this.rotationExpression+";\n  float offsetX;\n  float offsetY;\n  if (a_index == 0.0) {\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\n  } else if (a_index == 1.0) {\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\n  } else if (a_index == 2.0) {\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\n  } else {\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\n  }\n  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  vec4 texCoord = "+this.texCoordExpression+";\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;\n  v_texCoord = vec2(u, v);\n  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v_quadCoord = vec2(u, v);\n"+r.map((function(t){return"  "+t.name+" = "+t.expression+";"})).join("\n")+"\n}"},t.prototype.getSymbolFragmentShader=function(t){var e=t?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"",n=this.varyings;return t&&(n=n.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),"precision mediump float;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\n"+this.uniforms.map((function(t){return"uniform "+t+";"})).join("\n")+"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n"+n.map((function(t){return"varying "+t.type+" "+t.name+";"})).join("\n")+"\nvoid main(void) {\n  if ("+this.discardExpression+") { discard; }\n  gl_FragColor = "+this.colorExpression+";\n  gl_FragColor.rgb *= gl_FragColor.a;\n"+e+"\n}"},t}();var Ue=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Be=function(t){function e(e){var n=this,o=r({},e);return(n=t.call(this,o)||this).parseResult_=function(t){var e=t.symbol,n=void 0!==e.size?e.size:1,r=e.color||"white",o=e.textureCoord||[0,0,1,1],i=e.offset||[0,0],s=void 0!==e.opacity?e.opacity:1,a=void 0!==e.rotation?e.rotation:0,u={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{}},c=Re(u,n,xe|me),h=Re(u,i,xe),l=Re(u,o,xe),f={inFragmentShader:!0,variables:u.variables,attributes:[],stringLiteralsMap:u.stringLiteralsMap},p=Re(f,r,be),y=Re(f,s,me),d=Re(f,a,me),g="1.0",_="vec2("+Re(f,n,xe|me)+").x";switch(e.symbolType){case"square":case"image":break;case"circle":g="(1.0-smoothstep(1.-4./"+_+",1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))";break;case"triangle":var m="(v_quadCoord*2.-1.)",v="(atan("+m+".x,"+m+".y))";g="(1.0-smoothstep(.5-3./"+_+",.5,cos(floor(.5+"+v+"/2.094395102)*2.094395102-"+v+")*length("+m+")))";break;default:throw new Error("Unexpected symbol type: "+e.symbolType)}var b=(new Ve).setSizeExpression("vec2("+c+")").setRotationExpression(d).setSymbolOffsetExpression(h).setTextureCoordinateExpression(l).setSymbolRotateWithView(!!e.rotateWithView).setColorExpression("vec4("+p+".rgb, "+p+".a * "+y+" * "+g+")");if(t.filter){var O=Re(f,t.filter,Oe);b.setFragmentDiscardExpression("!"+O)}var x={};if(f.variables.forEach((function(e){b.addUniform("float u_"+e),x["u_"+e]=function(){if(!t.variables||void 0===t.variables[e])throw new Error("The following variable is missing from the style: "+e);var n=t.variables[e];return"string"==typeof n&&(n=Pe(u,n)),void 0!==n?n:-9999999}})),"image"===e.symbolType&&e.src){var C=new Image;C.src=e.src,b.addUniform("sampler2D u_texture").setColorExpression(b.getColorExpression()+" * texture2D(u_texture, v_texCoord)"),x.u_texture=C}return f.attributes.forEach((function(t){-1===u.attributes.indexOf(t)&&u.attributes.push(t),b.addVarying("v_"+t,"float","a_"+t)})),u.attributes.forEach((function(t){b.addAttribute("float a_"+t)})),{builder:b,attributes:u.attributes.map((function(t){return{name:t,callback:function(e,n){var r=n[t];return"string"==typeof r&&(r=Pe(u,r)),void 0!==r?r:-9999999}}})),uniforms:x}}(e.style),n.hitDetectionDisabled_=!!e.disableHitDetection,n}return Ue(e,t),e.prototype.createRenderer=function(){return new _e(this,{vertexShader:this.parseResult_.builder.getSymbolVertexShader(),fragmentShader:this.parseResult_.builder.getSymbolFragmentShader(),hitVertexShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolVertexShader(!0),hitFragmentShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolFragmentShader(!0),uniforms:this.parseResult_.uniforms,attributes:this.parseResult_.attributes})},e.prototype.disposeInternal=function(){this.renderer_.dispose(),t.prototype.disposeInternal.call(this)},e}(jt);e.default=Be},function(t,e,n){"use strict";n.r(e);var r=n(1),o=function(){function t(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function i(t,e,n,r,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new o(t,e,n,r)}var s=o,a=n(3),u=n(6),c=n(4);function h(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function l(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}var f=[0,0,0],p=function(){function t(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Object(r.a)(Object(a.c)(this.resolutions_,(function(t,e){return e-t}),!0),17),!t.origins)for(var n=0,o=this.resolutions_.length-1;n<o;++n)if(e){if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}else e=this.resolutions_[n]/this.resolutions_[n+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Object(r.a)(this.origins_.length==this.resolutions_.length,20));var i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=Object(u.e)(i)),Object(r.a)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Object(r.a)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,Object(r.a)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new s(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):i&&this.calculateTileRanges_(i)}return t.prototype.forEachTileCoord=function(t,e,n){for(var r=this.getTileRangeForExtentAndZ(t,e),o=r.minX,i=r.maxX;o<=i;++o)for(var s=r.minY,a=r.maxY;s<=a;++s)n([e,o,s])},t.prototype.forEachTileCoordParentTileRange=function(t,e,n,r){var o,s,a=null,u=t[0]-1;for(2===this.zoomFactor_?(o=t[1],s=t[2]):a=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(e(u,2===this.zoomFactor_?i(o=Math.floor(o/2),o,s=Math.floor(s/2),s,n):this.getTileRangeForExtentAndZ(a,u,n)))return!0;--u}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],o=2*t[2];return i(r,r+1,o,o+1,e)}var s=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null},t.prototype.getTileRangeExtent=function(t,e,n){var r=this.getOrigin(t),o=this.getResolution(t),i=h(this.getTileSize(t),this.tmpSize_),s=r[0]+e.minX*i[0]*o,a=r[0]+(e.maxX+1)*i[0]*o,c=r[1]+e.minY*i[1]*o,l=r[1]+(e.maxY+1)*i[1]*o;return Object(u.c)(s,c,a,l,n)},t.prototype.getTileRangeForExtentAndZ=function(t,e,n){var r=f;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,r);var o=r[1],s=r[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,r),i(o,r[1],s,r[2],n)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=h(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]},t.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),r=this.getResolution(t[0]),o=h(this.getTileSize(t[0]),this.tmpSize_),i=n[0]+t[1]*o[0]*r,s=n[1]-(t[2]+1)*o[1]*r,a=i+o[0]*r,c=s+o[1]*r;return Object(u.c)(i,s,a,c,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,n,r,o){var i=this.getZForResolution(n),s=n/this.getResolution(i),a=this.getOrigin(i),u=h(this.getTileSize(i),this.tmpSize_),c=r?.5:0,f=r?.5:0,p=Math.floor((t-a[0])/n+c),y=Math.floor((a[1]-e)/n+f),d=s*p/u[0],g=s*y/u[1];return r?(d=Math.ceil(d)-1,g=Math.ceil(g)-1):(d=Math.floor(d),g=Math.floor(g)),l(i,d,g,o)},t.prototype.getTileCoordForXYAndZ_=function(t,e,n,r,o){var i=this.getOrigin(n),s=this.getResolution(n),a=h(this.getTileSize(n),this.tmpSize_),u=r?.5:0,c=r?.5:0,f=Math.floor((t-i[0])/s+u),p=Math.floor((i[1]-e)/s+c),y=f/a[0],d=p/a[1];return r?(y=Math.ceil(y)-1,d=Math.ceil(d)-1):(y=Math.floor(y),d=Math.floor(d)),l(n,y,d,o)},t.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,e){var n=Object(a.d)(this.resolutions_,t,e||0);return Object(c.a)(n,this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n},t}();e.default=p}]);
//# sourceMappingURL=aol.all.min.js.map